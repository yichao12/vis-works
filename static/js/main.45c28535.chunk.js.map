{"version":3,"sources":["image/f1.jpg","image/f2.jpg","image/f3.jpg","image/f4.jpg","image/f5.jpg","image/f3a.jpg","image/snapshots/fire.png","components/fire/vis.js","util/particle.js","util/Draw_traj.js","components/fire/map.js","components/fire/index.js","components/board/index.js","components/urban/Scene.js","components/urban/TimeWidget.js","components/urban/index.js","App.js","serviceWorker.js","index.js"],"names":["module","exports","Vis","props","state","selectFloor","this","setTime","setInterval","bind","setState","curTime","Date","toLocaleString","slice","self","className","height","data","padding","scale","percent","type","min","max","forceFit","onGetG2Instance","g2Chart","chartIns","onPlotClick","ev","point","x","y","floor","getTooltipItems","sum","map","row","position","name","title","color","filed","opacity","style","stroke","lineWidth","tooltip","value","content","formatter","text","item","index","textStyle","fill","fontSize","fontWeight","React","Component","Particle","ctx","r","Math","random","vy","parseInt","vx","isFree","a","draw","beginPath","fillStyle","arc","PI","closePath","setPos","drawArrow","p1","p2","theta","headlen","width","undefined","angle","atan2","angle1","angle2","topX","cos","topY","sin","botX","botY","save","moveTo","lineTo","arrowX","arrowY","strokeStyle","restore","Object","assign","defineProperty","enumerable","configurable","writable","target","firstSource","TypeError","to","i","arguments","length","nextSource","keysArray","keys","nextIndex","len","nextKey","desc","getOwnPropertyDescriptor","arrowTo","arrowOptions","opts","startOffset","endOffset","offset","activeIndex","activeColor","stepLength","justifyAlign","arrowLength","arrowTheta","arrowHeadlen","arrowLineWidth","sqrt","pow","loops","highlightIndex","hudu","p0","pics","pic_f1","pic_f2","pic_f3","pic_f3a","pic_f4","pic_f5","getRandomInt","ceil","Map","canvas","createRef","TrajsCanvas","floorTrajs","console","log","drawBurns","current","clientHeight","clientWidth","getContext","particles","boundry","center","xmin","xmax","ymin","ymax","p","push","globalCompositeOperation","timeoutId","clearRect","myCanvas","_index","selfthis","BW","BH","infs","onClick","return","src","ref","Fire","floors","types","j","round","toLowerCase","vis","handleFlooeSelect","handleReturn","Board","route","history","coverStyle","gutter","span","hoverable","cover","alt","fireImg","redirectTo","Meta","description","href","shape","icon","withRouter","MyMap","createInstance","nextProps","hour","drawLinesUpdate","trajs","scene","L7","id","mapStyle","pitch","zoom","zoomControl","scaleControl","attributionControl","on","getKakous","kakou","getTrajs","drawPoints","arr","Promise","resolve","reject","d3","then","kakous","ids","Set","kakouMap","lng","lat","has","set","add","ps","trajUrl","trajsUrlBase","s","e","s_p","get","e_p","lng1","lat1","lng2","lat2","all","points","pl","PointLayer","zIndex","source","parser","size","active","strokeWidth","render","setHeight","ll","LineLayer","animate","enable","interval","duration","trailLength","lines","trajsLayer","setData","x1","y1","margin","div","mapWrapper","TIME_GAP","Statistic","Countdown","now","getTime","d","format","prototype","fmt","o","getMonth","getDate","getHours","getMinutes","getSeconds","getMilliseconds","k","test","replace","RegExp","$1","getFullYear","substr","marks","0","6","12","18","24","IntegerStep","onChange","updateMapTime","handleStartChange","start","_startId","timer","startId","clearInterval","updateTime","checked","Widgets","Urban","h","mapTime","handleUpdateMapTime","App","basename","path","exact","component","Boolean","window","location","hostname","match","ReactDOM","document","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"uHAAAA,EAAOC,QAAU,IAA0B,gC,oBCA3CD,EAAOC,QAAU,IAA0B,gC,oBCA3CD,EAAOC,QAAU,IAA0B,gC,oBCA3CD,EAAOC,QAAU,IAA0B,gC,oBCA3CD,EAAOC,QAAU,IAA0B,gC,oBCA3CD,EAAOC,QAAU,IAA0B,iC,oBCA3CD,EAAOC,QAAU,IAA0B,kC,kWC6I5BC,G,mBA/Hb,WAAYC,GAAO,IAAD,8BAChB,4CAAMA,KACDC,MAAQ,CACXC,YAAc,IAHA,E,kFAUhBC,KAAKC,UACLC,YAFWF,KAEMC,QAAQE,KAFdH,MAE0B,O,gCAIrCA,KAAKI,SAAS,CAACC,SAAS,IAAKC,MAAOC,iBAAiBC,MAAM,GAAG,O,+BAI9D,IAOIC,EAAOT,KAEX,OACE,6BACE,wBAAIU,UAAU,SAAd,oDAGA,yBAAKA,UAAU,uBACb,wBAAIA,UAAU,aAAd,gBAGA,wBAAIA,UAAU,aACXV,KAAKF,MAAMO,UAGhB,kBAAC,QAAD,CAAOM,OAAQ,IAAKC,KAAMZ,KAAKH,MAAMe,KAAOC,QAAS,GAAIC,MAtB/C,CACZC,QAAQ,CACNC,KAAK,SACLC,IAAI,EACJC,IAAI,MAkBmEC,UAAQ,EAC5EC,gBAAiB,SAAAC,GAAYZ,EAAKa,SAAWD,GAC7CE,YAAa,SAAAC,GACV,IAAIC,EAAQ,CACVC,EAAGF,EAAGE,EACNC,EAAGH,EAAGG,GAGJC,EADQnB,EAAKa,SAASO,gBAAgBJ,GACxB,GAAN,kBACZhB,EAAKL,SAAS,CAAEL,YAAc6B,IAE9B,IAAIE,EAAM,EACVrB,EAAKZ,MAAMe,KAAKmB,KAAI,SAACC,GAChBA,EAAG,OAAcJ,IACjBE,GAAOE,EAAG,YAIfvB,EAAKZ,MAAME,YAAY6B,EAAQE,EAAI,OAIvC,kBAAC,SAAD,CAASG,SAAS,QAClB,kBAAC,OAAD,CAAMC,KAAK,eAAMC,MAAM,iBACvB,kBAAC,OAAD,CAAMD,KAAK,uBACX,kBAAC,UAAD,MACA,kBAAC,OAAD,CACElB,KAAK,gBACLiB,SAAS,gBACTG,MAAO,CAAC,OAAS,SAACC,GAChB,IAAID,EAAQ,CAAC,UAAU,WACvB,MAAgB,4BAATC,EAAkBD,EAAM,GAAKA,EAAM,KAE5CE,QAAS,CAAC,QAAU,SAACV,GACnB,MAA6B,IAA1BnB,EAAKX,MAAMC,YAA0B,EACrC6B,GAASnB,EAAKX,MAAMC,YACd,EACF,KAGTwC,MAAO,CACLC,OAAQ,OACRC,UAAW,GAGbC,QAAS,CAAC,qBAAsB,SAACd,EAAOb,EAAQC,GAC9C,MAAO,CACLkB,KAAM,gBAAQN,EACdO,MAAOnB,EACP2B,MAAO,qBAAQ5B,EAAU,QAI/B,kBAAC,QAAD,CACE6B,QAAQ,OACRC,UAAW,SAACC,EAAMC,EAAMC,GAKtB,IAAIvB,EAAQsB,EAAKtB,MAEbK,EAAM,EAQV,OANArB,EAAKZ,MAAMe,KAAKmB,KAAI,SAACC,GAChBA,EAAG,OAAcP,EAAK,QACtBK,GAAOE,EAAG,YAIE,4BAAdP,EAAMT,KACAc,EAAM,IACR,MAEPmB,UAAW,CACTC,KAAM,QACNC,SAAU,KACVC,WAAY,iB,GAxHVC,IAAMC,Y,qHCuBTC,EAnCA,SAASC,GACvBxD,KAAKyD,EAAoB,EAAhBC,KAAKC,SAGd3D,KAAK0B,GAAK,IACV1B,KAAK2B,GAAK,IAGV3B,KAAK4D,IAAM,EAAIC,SAAyB,GAAhBH,KAAKC,UAC7B3D,KAAK8D,IAAM,EAAID,SAAyB,GAAhBH,KAAKC,UAG7B3D,KAAK+D,QAAS,EAEd/D,KAAKgE,EAAIN,KAAKC,SAGd3D,KAAKiE,KAAO,WACXT,EAAIU,YAGJV,EAAIW,UAAY,qBAAsBnE,KAAKgE,EAAE,IAC7CR,EAAIY,IAAIpE,KAAK0B,EAAG1B,KAAK2B,EAAG3B,KAAKyD,EAAG,EAAW,EAARC,KAAKW,IAAM,GAC9Cb,EAAIN,OACJM,EAAIc,aAILtE,KAAKuE,OAAS,SAAS7C,EAAGC,GACzB3B,KAAK0B,EAAIA,EACT1B,KAAK2B,EAAIA,ICuDP,SAAS6C,EAAUhB,EAAKiB,EAAIC,EAAIC,EAAOC,EAASC,EAAOzC,GACnDuC,OAAmBG,IAAVH,GAAiC,OAAVA,EAAkBA,EAAQ,GAC1DC,OAAuBE,IAAZF,GAAqC,OAAZA,EAAoBA,EAAU,EAClEC,OAAmBC,IAAVD,GAAiC,OAAVA,EAAkBA,EAAQ,EAC1DzC,OAAmB0C,IAAV1C,GAAiC,OAAVA,EAAkBA,EAAQ,OAG1D,IAAI2C,EAA+C,IAAvCrB,KAAKsB,MAAMP,EAAG9C,EAAI+C,EAAG/C,EAAG8C,EAAG/C,EAAIgD,EAAGhD,GAAWgC,KAAKW,GAC1DY,GAAUF,EAAQJ,GAASjB,KAAKW,GAAK,IACrCa,GAAUH,EAAQJ,GAASjB,KAAKW,GAAK,IACrCc,EAAOP,EAAUlB,KAAK0B,IAAIH,GAC1BI,EAAOT,EAAUlB,KAAK4B,IAAIL,GAC1BM,EAAOX,EAAUlB,KAAK0B,IAAIF,GAC1BM,EAAOZ,EAAUlB,KAAK4B,IAAIJ,GAC9B1B,EAAIiC,OAEJjC,EAAIU,YAGJV,EAAIkC,OAAOjB,EAAG/C,EAAG+C,EAAG9C,GACpB6B,EAAImC,OAAOjB,EAAGhD,EAAGgD,EAAG/C,GAIpB,IAAIiE,EAASlB,EAAGhD,EAAIyD,EAChBU,EAASnB,EAAG/C,EAAI0D,EACpB7B,EAAIkC,OAAOE,EAAQC,GACnBrC,EAAImC,OAAOjB,EAAGhD,EAAGgD,EAAG/C,GACpBiE,EAASlB,EAAGhD,EAAI6D,EAChBM,EAASnB,EAAG/C,EAAI6D,EAChBhC,EAAImC,OAAOC,EAAQC,GAInBrC,EAAIsC,YAAc1D,EAClBoB,EAAIf,UAAYoC,EAChBrB,EAAIhB,SAGJgB,EAAIuC,UAKHC,OAAOC,QACRD,OAAOE,eAAeF,OAAQ,SAAU,CACpCG,YAAY,EACZC,cAAc,EACdC,UAAU,EACV1D,MAAO,SAAU2D,EAAQC,GAErB,QAAezB,IAAXwB,GAAmC,OAAXA,EACxB,MAAM,IAAIE,UAAU,2CAExB,IADA,IAAIC,EAAKT,OAAOM,GACPI,EAAI,EAAGA,EAAIC,UAAUC,OAAQF,IAAK,CACvC,IAAIG,EAAaF,UAAUD,GAC3B,QAAmB5B,IAAf+B,GAA2C,OAAfA,EAEhC,IADA,IAAIC,EAAYd,OAAOe,KAAKf,OAAOa,IAC1BG,EAAY,EAAGC,EAAMH,EAAUF,OAAQI,EAAYC,EAAKD,IAAa,CAC1E,IAAIE,EAAUJ,EAAUE,GACpBG,EAAOnB,OAAOoB,yBAAyBP,EAAYK,QAC1CpC,IAATqC,GAAsBA,EAAKhB,aAAYM,EAAGS,GAAWL,EAAWK,KAG5E,OAAOT,KAKRY,MA1Jf,SAAiB7D,EAAKiB,EAAIC,EAAI4C,GAEtB,IAAIC,EAAO,CACPC,YAAa,EACbC,UAAW,EACXC,OAAQ,EACRtF,MAAO,UACPuF,aAAc,EACdC,YAAa,UACbC,WAAY,EACZC,cAAc,EACdC,YAAa,GACbC,WAAY,GACZC,aAAc,EACdC,eAAgB,EAChBzF,UAAW,QAIMqC,IAAjBwC,GAA+C,OAAjBA,IAC9BC,EAAOvB,OAAOC,OAAOsB,EAAMD,IAI/B,IAAIL,EAAMvD,KAAK9B,MAAM8B,KAAKyE,KAAKzE,KAAK0E,IAAI3D,EAAG/C,EAAIgD,EAAGhD,EAAG,GAAKgC,KAAK0E,IAAI3D,EAAG9C,EAAI+C,EAAG/C,EAAG,KAE5E0G,EAAQ3E,KAAK9B,OAAOqF,GAAOM,EAAKC,YAAcD,EAAKG,OAASH,EAAKE,WAAaF,EAAKM,aAAeN,EAAKQ,YAAcR,EAAKM,cAEpG,IAAtBN,EAAKO,eACLP,EAAKM,YAAcZ,GAAOM,EAAKC,YAAcD,EAAKG,OAASH,EAAKE,WAAcF,EAAKQ,YAAcM,IAAWA,EAAQ,IAKxH,IAAIC,EAAiB,EACjBf,EAAKI,YAAc,IAEfW,EADCf,EAAKI,YAAcU,IAAW,EACdA,EAGAd,EAAKI,YAAcU,GAS5C,IAJA,IAEI5E,EACArB,EAHAmG,EAAO7E,KAAKsB,MAAMP,EAAG9C,EAAI+C,EAAG/C,EAAG+C,EAAGhD,EAAI+C,EAAG/C,GACzC8G,EAAU/D,EAAG/C,EAAb8G,EAAmB/D,EAAG9C,EAGjB+E,EAAI,EAAGA,EAAI2B,EAAO3B,IAEvBjD,EAAK8D,EAAKC,YAAcD,EAAKG,QAAWH,EAAKQ,YAAcR,EAAKM,YAAcnB,EAC9EjC,EAAK,CACD/C,EAAG8G,EAAO9E,KAAK0B,IAAImD,GAAQ9E,EAC3B9B,EAAG6G,EAAO9E,KAAK4B,IAAIiD,GAAQ9E,GAK/BA,GAAQ8D,EAAKQ,YACbrD,EAAK,CACDhD,EAAG8G,EAAO9E,KAAK0B,IAAImD,GAAQ9E,EAC3B9B,EAAG6G,EAAO9E,KAAK4B,IAAIiD,GAAQ9E,GAK3BrB,EADAkG,EAAiB,GAAK5B,IAAO4B,EAAiB,EACtCf,EAAKK,YAGLL,EAAKnF,MAEjBoC,EAAUhB,EAAKiB,EAAIC,EAAI6C,EAAKS,WAAYT,EAAKU,aAAcV,EAAKW,eAAgB9F,IC7DtFqG,EAAO,CACZ,GAAOC,IACP,GAAOC,IACP,GAAOC,IACP,IAAQC,IACR,GAAOC,IACP,GAAOC,KA8OR,SAASC,EAAa/H,EAAKC,GAGvB,OAFAD,EAAMyC,KAAKuF,KAAKhI,GAChBC,EAAMwC,KAAK9B,MAAMV,GACVwC,KAAK9B,MAAM8B,KAAKC,UAAYzC,EAAMD,EAAM,IAAMA,EAK1CiI,M,YAjPb,WAAYrJ,GAAO,IAAD,8BAChB,4CAAMA,KACDC,MAAQ,GAGb,EAAKqJ,OAAS9F,IAAM+F,YACpB,EAAKC,YAAchG,IAAM+F,YACzB,EAAKE,WAAY,CACZ,GAAO,CACJ,OAAS,CAAE5H,EAAG,IAAKC,EAAG,KACtB,MAAQ,CACF,CAAC,CAAED,EAAG,IAAKC,EAAG,KAAM,CAAED,EAAG,IAAKC,EAAG,KACjC,CAAC,CAAED,EAAG,IAAKC,EAAG,IAAK,CAAED,EAAG,IAAKC,EAAG,KAChC,CAAC,CAAED,EAAG,IAAKC,EAAG,KAAM,CAAED,EAAG,IAAKC,EAAG,MACjC,CAAC,CAACD,EAAG,IAAKC,EAAG,KAAM,CAAED,EAAG,IAAKC,EAAG,MAChC,CAAC,CAAED,EAAG,IAAKC,EAAG,KAAM,CAAED,EAAG,IAAKC,EAAG,QAGrC,GAAO,CACT,OAAS,CAAED,EAAG,IAAKC,EAAG,KACtB,MAAQ,CACF,CAAC,CAAED,EAAG,IAAKC,EAAG,KAAM,CAAED,EAAG,IAAKC,EAAG,MACjC,CAAC,CAAED,EAAG,IAAKC,EAAG,KAAM,CAAED,EAAG,IAAKC,EAAG,MACjC,CAAC,CAAED,EAAG,IAAKC,EAAG,KAAM,CAAED,EAAG,IAAKC,EAAG,MACjC,CAAC,CAACD,EAAG,IAAKC,EAAG,KAAM,CAAED,EAAG,IAAKC,EAAG,MAChC,CAAC,CAAED,EAAG,IAAKC,EAAG,KAAM,CAAED,EAAG,IAAKC,EAAG,QAGrC,GAAM,CACR,OAAS,CAAED,EAAG,IAAKC,EAAG,KACtB,MAAQ,CACH,CAAC,CAAED,EAAG,IAAKC,EAAG,KAAM,CAAED,EAAG,IAAKC,EAAG,KAChC,CAAC,CAAED,EAAG,IAAKC,EAAG,IAAK,CAAED,EAAG,IAAKC,EAAG,KAChC,CAAC,CAAED,EAAG,IAAKC,EAAG,KAAM,CAAED,EAAG,IAAKC,EAAG,MACjC,CAAC,CAACD,EAAG,IAAKC,EAAG,KAAM,CAAED,EAAG,IAAKC,EAAG,KAChC,CAAC,CAAED,EAAG,IAAKC,EAAG,KAAM,CAAED,EAAG,IAAKC,EAAG,QAGrC,IAAQ,CACV,OAAS,CAAED,EAAG,IAAKC,EAAG,KACtB,MAAQ,CACF,CAAC,CAAED,EAAG,IAAKC,EAAG,KAAM,CAAED,EAAG,IAAKC,EAAG,MACjC,CAAC,CAAED,EAAG,IAAKC,EAAG,KAAM,CAAED,EAAG,IAAKC,EAAG,MACjC,CAAC,CAAED,EAAG,IAAKC,EAAG,KAAM,CAAED,EAAG,IAAKC,EAAG,QAKrC,GAAO,CACT,OAAS,CAAED,EAAG,IAAKC,EAAG,KACtB,MAAQ,CACF,CAAC,CAAED,EAAG,IAAKC,EAAG,KAAM,CAAED,EAAG,IAAKC,EAAG,MACjC,CAAC,CAACD,EAAG,IAAKC,EAAG,KAAK,CAAED,EAAG,IAAKC,EAAG,KAC/B,CAAC,CAACD,EAAG,IAAKC,EAAG,KAAM,CAAED,EAAG,IAAKC,EAAG,MAChC,CAAC,CAACD,EAAG,IAAKC,EAAG,KAAM,CAAED,EAAG,IAAKC,EAAG,MAChC,CAAC,CAAED,EAAG,IAAKC,EAAG,KAAM,CAAED,EAAG,IAAKC,EAAG,OAGrC,GAAO,CACT,OAAS,CAAED,EAAG,IAAKC,EAAG,KACtB,MAAQ,CACF,CAAC,CAAED,EAAG,IAAKC,EAAG,KAAM,CAAED,EAAG,IAAKC,EAAG,MACjC,CAAC,CAAED,EAAG,IAAKC,EAAG,KAAM,CAAED,EAAG,IAAKC,EAAG,KACjC,CAAC,CAACD,EAAG,IAAKC,EAAG,KAAM,CAAED,EAAG,IAAKC,EAAG,MAChC,CAAC,CAAED,EAAG,IAAKC,EAAG,KAAM,CAAED,EAAG,IAAKC,EAAG,SAhE/B,E,iFAuEjB4H,QAAQC,IAAIxJ,KAAKmJ,QAEjBnJ,KAAKyJ,c,kCAML,IAAIN,EAASnJ,KAAKmJ,OAClB,GAAIA,GAAYA,EAAOO,QAAvB,CAGA,IAAI/I,GADJwI,EAASnJ,KAAKmJ,OAAOO,SACDC,aAChB9E,EAASsE,EAAOS,YAChBpG,EAAM2F,EAAOU,WAAW,MAExBC,EAAY,GAEZC,EACI,GADJA,EAEI,IAFJA,EAGG,GAHHA,EAII,IAGHhJ,EAAUf,KAAKH,MAAMkB,QAgBrBiJ,EARY,CACd,GAAO,CAAC,GAAG,IACX,GAAO,CAAC,IAAI,IACZ,GAAO,CAAC,IAAI,IACZ,IAAQ,CAAC,IAAI,IACb,GAAQ,CAAC,IAAI,IACb,GAAQ,CAAC,IAAI,KAEQhK,KAAKH,MAAM+B,OAa9BqI,EAAOD,EAAO,GAAKD,EAAgBhJ,EAAU,EAC/CmJ,EAAOF,EAAO,GAAKD,EAAgBhJ,EAAU,EAC7CoJ,EAAOH,EAAO,GAAKD,EAAiBhJ,EAAU,EAC9CqJ,EAAOJ,EAAO,GAAKD,EAAiBhJ,EAAU,EAE9CkJ,EAASA,EAAOF,EAAkBA,EAAeE,EACjDE,EAASA,EAAOJ,EAAkBA,EAAcI,EAChDD,EAASA,EAAQH,EAAaA,EAAmBA,EAAaA,EAAiBG,EAC/EE,EAASA,EAAQL,EAAYA,EAAoBA,EAAYA,EAAkBK,EAIjF,IAAI,IAAI1D,EAAI,EAAEA,EAAI,IAAI3F,EAAQ2F,IAAI,CAChC,IAAI2D,EAAI,IAAI9G,EAASC,GACrB6G,EAAE3I,EAAIsH,EAAaiB,EAAOC,GAC1BG,EAAE1I,EAAIqH,EAAamB,EAAOC,GAC1BN,EAAUQ,KAAKD,GAEjB7G,EAAI+G,yBAA2B,UAkB/B,IAAIC,EAAYtK,aAhBhB,WAcEsD,EAAIiH,UAAU,EAAG,EAAG5F,EAAOlE,GAZ3BmJ,EAAU/H,KAAI,SAACsI,GACbA,EAAE5G,GAAK,IACT4G,EAAErG,GAAK,KACJqG,EAAErG,EAAI,IACPqG,EAAE5G,EAAoB,EAAhBC,KAAKC,SACX0G,EAAErG,EAAIN,KAAKC,UAEb0G,EAAEpG,YAOgC,IAAO,IAC3CjE,KAAKI,SAAS,CAAEoK,iB,kCAKhB,IAAIE,EAAW1K,KAAKqJ,YACpB,GAAIqB,GAAcA,EAAShB,QAA3B,EAEAgB,EAAW1K,KAAKqJ,YAAYK,SACNC,aACTe,EAASd,YACtBc,EAAS7F,MAAQ,IACjB6F,EAAS/J,OAAS,IAElB,IAAI6C,EAAMkH,EAASb,WAAW,MAO1Bc,EAAS,EACTC,EAAW5K,KACfE,aAAY,WAER,IAAI2K,EAAKH,EAAS7F,MACdiG,EAAKJ,EAAS/J,OAElB,GADA6C,EAAIiH,UAAU,EAAG,EAAGI,EAAIC,GACrBF,EAAS/K,MAAM+B,MAChB,IAAImJ,EAAOH,EAAStB,WAAWsB,EAAS/K,MAAM+B,YAE1CmJ,EAAOH,EAAStB,WAAT,GACb9F,EAAIU,YACJV,EAAIW,UAAY,MAChBX,EAAIY,IAAI2G,EAAI,OAAJ,EAAoBA,EAAI,OAAJ,EAAoB,EAAG,EAAW,EAARrH,KAAKW,IAAM,GACjEb,EAAIN,OACJM,EAAIc,YAGJ,IADA,IAAIoD,EAAUiD,EAAS,EAAK,EACpBjE,EAAE,EAAEA,EAAEqE,EAAI,MAAUnE,OAAOF,IAEjCW,EAAQ7D,EAAIuH,EAAI,MAAUrE,GAAG,GAAIqE,EAAI,MAAUrE,GAAG,GAAG,CAAEgB,OAAQA,EAAQtF,MAAO,MAAO0F,cAAc,IASjG6C,GAAU,GACVA,EAAS,EAGTA,MAEL,Q,+BAGH,OACE,yBAAKjK,UAAU,aACb,wBAAIA,UAAU,aAAasK,QAAShL,KAAKH,MAAMoL,QAA/C,kBACA,yBAAKC,IAAKzC,EAAMzI,KAAKH,MAAM+B,QAAY6G,EAAI,GAAS/H,UAAU,UAC9D,4BAAQyK,IAAKnL,KAAKmJ,SAClB,4BAAQgC,IAAKnL,KAAKqJ,mB,GApORhG,IAAMC,W,SCgET8H,E,YAvEb,WAAYvL,GAAO,IAAD,8BAChB,4CAAMA,KACDC,MAAQ,CACX8B,MAAQ,GACRb,QAAS,GAJK,E,kFAahB,IAJA,IAAIsK,EAAS,CAAC,KAAK,KAAK,KAAK,MAAM,KAAK,MACpCC,EAAS,CAAC,2BAAO,4BACjB1K,EAAO,GAEH8F,EAAI,EAAEA,EAAI2E,EAAOzE,OAAOF,IAC9B,IAAI,IAAI6E,EAAI,EAAEA,EAAID,EAAM1E,OAAO2E,IAAI,CAC/B,IAAIxK,EAAU2C,KAAK8H,MAAsB,GAAhB9H,KAAKC,UACd,MAAb0H,EAAO3E,IAA0B,4BAAZ4E,EAAMC,KAC1BxK,EAAU,IACE,MAAbsK,EAAO3E,IAA0B,4BAAZ4E,EAAMC,KAC1BxK,EAAU,IAEdH,EAAK0J,KAAK,CACR,MAAUe,EAAO3E,GACjB,KAAU4E,EAAMC,GAChB,QAAYxK,IAIpBf,KAAKI,SAAS,CACZQ,W,wCAIcgB,EAAQb,GACxBf,KAAKI,SAAS,CACZwB,MAAMA,EAAM6J,cACZ1K,QAAUA,M,qCAKZwI,QAAQC,IAAI,UACZxJ,KAAKI,SAAS,CACXwB,MAAQ,O,+BAMX,IAAM8J,EAAO,kBAAC,EAAD,CACK9K,KAAMZ,KAAKF,MAAMc,KACjBb,YAAaC,KAAK2L,kBAAkBxL,KAAKH,QAGrD+B,EAAO,kBAAC,EAAD,CACKH,MAAO5B,KAAKF,MAAM8B,MAClBqJ,OAAQjL,KAAK4L,aAAazL,KAAKH,MAC/Be,QAASf,KAAKF,MAAMiB,UAGxC,OACE,yBAAKL,UAAU,YACb,yBAAKA,UAAU,SACb,kBAAC,IAAD,KACyB,IAApBV,KAAKF,MAAM8B,MAAe8J,EAAQ3J,S,GAlE5BsB,IAAMC,W,oDCLnBuI,E,YAEJ,WAAYhM,GAAO,IAAD,8BAChB,4CAAMA,KACDC,MAAQ,GAFG,E,sHAWPgM,GACT9L,KAAKH,MAAMkM,QAAQzB,KAAKwB,K,+BAKxB,IAAME,EAAa,CACjBrL,OAAS,SAEb,OACA,yBAAKD,UAAU,aACb,kBAAC,IAAD,CAAKuL,OAAQ,IAEX,kBAAC,IAAD,CAAKC,KAAM,GACT,kBAAC,IAAD,CACEC,WAAS,EACTC,MAAO,yBAAKC,IAAI,UAAUnB,IAAKoB,IAAS/J,MAAOyJ,IAC/ChB,QAAShL,KAAKuM,WAAWpM,KAAKH,KAAK,UAEnC,kBAAC,IAAKwM,KAAN,CACErK,MAAM,iCACNsK,YAAY,2FAIlB,kBAAC,IAAD,CAAKP,KAAM,GACT,kBAAC,IAAD,CACEC,WAAS,EACTC,MAAO,yBAAKC,IAAI,UAAW9J,MAAOyJ,IAClChB,QAAShL,KAAKuM,WAAWpM,KAAKH,KAAK,WAEnC,kBAAC,IAAKwM,KAAN,CACErK,MAAM,iCACNsK,YAAY,sDAKpB,yBAAK/L,UAAU,iBACb,uBAAGgM,KAAK,wCACN,kBAAC,IAAD,CAAQC,MAAM,SAASC,KAAK,kB,GArDhBvJ,IAAMC,WA6DXuJ,cAAWhB,G,mDC4LXiB,E,YA/Ob,WAAYjN,GAAQ,IAAD,8BACjB,4CAAMA,KAJRC,MAAQ,GAGW,E,iFAKjBE,KAAK+M,mB,gDAEmBC,GAExB,GAAIhN,KAAKH,MAAMoN,OAASD,EAAUC,MAAQjN,KAAKH,MAAMoN,KAAM,CACvD,IAAIA,EAAOD,EAAUC,KACrB1D,QAAQC,IAAI,SAAWyD,GACvBjN,KAAKkN,gBAAgBlN,KAAKF,MAAMqN,MAAMF,O,yJAItCxM,EAAOT,KACPoN,EAAQ,IAAIC,QAAS,CACvBC,GAAI,MAEJC,SAAU,QACVvD,OAAQ,CAAC,cAAe,eAExBwD,MAAO,GAEPC,KAAM,KACNC,aAAa,EACbC,cAAc,EACdC,oBAAoB,IAEtB5N,KAAKoN,MAAQA,EACbA,EAAMS,GAAG,SAAT,sBAAmB,8BAAA7J,EAAA,sEACGvD,EAAKqN,YADR,cACXC,EADW,gBAEGtN,EAAKuN,SAASD,EAAMhM,KAFvB,OAEXoL,EAFW,OAGf5D,QAAQC,IAAI2D,GACZ1M,EAAKwN,WAAWF,EAAMG,KACtBzN,EAAKL,SAAS,CAAE+M,UALD,4C,2QAiBZ,IAAIgB,SAAQ,SAACC,EAAQC,GACxBC,IAvDY,8CAuDQC,MAAK,SAAC3N,GACxB,IAAI4N,EAAS,GACTC,EAAM,IAAIC,IACVC,EAAW,IAAIzF,IAEnBtI,EAAKmB,KAAI,SAACC,GACN,GAAsB,sBAAnBA,EAAG,SAAsB,CACxB,IAAIsL,EAAKtL,EAAG,KACR4M,GAAQ5M,EAAG,UACX6M,GAAQ7M,EAAG,SACXyM,EAAIK,IAAIxB,KACVkB,EAAOlE,KAAK,CACRgD,KAAKsB,MAAMC,MACX3M,KAAOoL,IAYXqB,EAASI,IAAIzB,EAAK,CAAEsB,MAAKC,SAE3BJ,EAAIO,IAAIhN,EAAG,UAGnBuH,QAAQC,IAAIgF,EAAO5H,QAKnBwH,EAAS,CAAEF,IAAIM,EAAOzM,IAAI4M,W,yKAInBA,G,2EAIb,IAFIM,EAAK,G,WAEDvI,GACJ,IAAI2D,EAAI,IAAI8D,SAAQ,SAACC,EAAQC,GAEjB,IAAIa,EAAUC,yCAAyBzI,EAAI,OAC3C4H,IAAOY,GAASX,MAAK,SAAC3N,GACpB,IAAIuM,EAAQ,GACZvM,EAAKmB,KAAI,SAACC,GACR,IAAIoN,EAAIpN,EAAG,EACPqN,EAAIrN,EAAG,EACPsN,EAAMX,EAASY,IAAIH,GACnBI,EAAMb,EAASY,IAAI,GAAGF,GACvBC,GAAOE,GACRrC,EAAM7C,KAAK,CACTmF,KAAOH,EAAG,IACVI,KAAOJ,EAAG,IACVK,KAAOH,EAAG,IACVI,KAAOJ,EAAG,SAIhBjG,QAAQC,IAAI2D,EAAMvG,QAClBwH,EAASjB,SAIvB8B,EAAG3E,KAAMD,IAzBL3D,EAAI,EAAEA,EAAI,GAAGA,IAAK,EAAlBA,G,yBA4BDyH,QAAQ0B,IAAIZ,I,mIAEVa,GACP,IACIC,EADO/P,KACGoN,MAAM4C,WAAW,CAC3BC,OAAQ,IAEXC,OAAOJ,EAAO,CACbK,OAAO,CACHnP,KAAK,OACLU,EAAI,MACJC,EAAI,MACJO,KAAM,UAGXyK,MAAM,UAENyD,KAAK,GACLC,QAAO,GACPjO,MAAM,WACNG,MAAM,CACLD,QAAS,GACTgO,YAAa,IAEdC,SACDR,EAAGS,UAAU,IAEbT,EAAGlC,GAAG,SAAS,SAACrM,GACd+H,QAAQC,IAAIhI,Q,yCAIhB,IAEIiP,EAFOzQ,KAEGoN,MAAMsD,UAAU,CAC5BT,OAAQ,IAETtD,MAAM,QACNyD,KAAK,GACLhO,MAAM,WACNG,MAAM,CACLD,QAAS,MAEVqO,QAAQ,CACPC,QAAO,EACPC,SAAS,GACTC,SAAS,EACTC,YAAY,KAEbR,SAGD,OAFAhH,QAAQC,IAAIiH,GAELA,I,sCAGOO,GAGd,GADWhR,KACFiR,WA6BP1H,QAAQC,IAAIwH,EAAMpK,QA9BT5G,KA+BCiR,WACPC,QAAQF,EAAO,CAChBb,OAAQ,CACNnP,KAAK,OACLU,EAAG,OACHC,EAAG,OACHwP,GAAI,OACJC,GAAI,cArCU,CAClB,IAAIX,EAFKzQ,KAEKoN,MAAMsD,UAAU,CAC5BT,OAAQ,IAETC,OAAOc,EAAO,CACbb,OAAQ,CACNnP,KAAK,OACLU,EAAG,OACHC,EAAG,OACHwP,GAAI,OACJC,GAAI,UAGPzE,MAAM,QACNyD,KAAK,GACLhO,MAAM,WACNG,MAAM,CACLD,QAAS,MAEVqO,QAAQ,CACPC,QAAO,EACPC,SAAS,GACTC,SAAS,EACTC,YAAY,KAEbR,SA1BQvQ,KA4BJiR,WAAaR,K,+BAgBZ,IAAD,OACP,OACE,yBACEnD,GAAG,MACH/K,MAAO,CACLsC,MAAO,OACPwM,OAAQ,IACR1Q,OAAQ,OACRsB,SAAU,YAEZkJ,IAAK,SAAAmG,GACH,EAAKC,WAAaD,S,GA5ORhO,a,mCCFdkO,IAHgBC,IAAdC,UACSpR,KAAKqR,MAEL,KA2BjB,SAASC,GAAQ3E,GACf,IAOI4E,EAAI,IAAIvR,KAPD,KACC,EACA,EACA2M,EACE,EACA,EACK,GAGnB,OADA4E,EAAIA,EAAEC,OAAO,YAlCfxR,KAAKyR,UAAUD,OAAS,SAASE,GAC/B,IAAIC,EAAI,CACN,KAAOjS,KAAKkS,WAAW,EACvB,KAAOlS,KAAKmS,UACZ,KAAOnS,KAAKoS,WACZ,KAAOpS,KAAKqS,aACZ,KAAOrS,KAAKsS,aACZ,KAAO5O,KAAK9B,OAAO5B,KAAKkS,WAAW,GAAG,GACtC,EAAOlS,KAAKuS,mBAOd,IAAI,IAAIC,IAJL,OAAOC,KAAKT,KACbA,EAAIA,EAAIU,QAAQC,OAAOC,IAAK5S,KAAK6S,cAAc,IAAIC,OAAO,EAAIH,OAAOC,GAAGhM,UAG7DqL,EACR,IAAIU,OAAO,IAAKH,EAAG,KAAKC,KAAKT,KAC9BA,EAAMA,EAAIU,QACRC,OAAOC,GAAuB,GAAlBD,OAAOC,GAAGhM,OAAcqL,EAAEO,IAAQ,KAAMP,EAAEO,IAAIM,QAAQ,GAAIb,EAAEO,IAAI5L,UAIlF,OAAOoL,GAgBT,IAAMe,GAAQ,CACZC,EAAI,OACJC,EAAI,OACJC,GAAI,QACJC,GAAI,QACJC,GAAI,SAGAC,G,YACJ,WAAYxT,GAAO,IAAD,8BAChB,4CAAMA,KAYRyT,SAAW,SAAA3Q,GACT,EAAKvC,SAAS,CACZ6M,KAAMtK,IAGR,EAAK9C,MAAM0T,cAAc5Q,IAlBT,EAgClB6Q,kBAAoB,SAACC,GAEnB,IAAIhT,EAAI,eACR,GAAGgT,EAAM,CACP,IAAIC,EAAWxT,YAAYO,EAAKkT,MAAMxT,KAAKM,GAAM+Q,IACjD/Q,EAAKL,SAAS,CAAEwT,QAAQF,SAExBG,cAAepT,EAAKX,MAAM8T,SAE5B,EAAKxT,SAAS,CAAEqT,WAvChB,EAAK3T,MAAQ,CACXmN,KAAO,EACPwG,OAAO,EACPG,QAAU,GALI,E,mHAuBL5T,KAEHF,MAAMmN,MAAQ,IACpB4G,cAHS7T,KAGWF,MAAM8T,SAE5B,IAAIE,EALO9T,KAKWF,MAAMmN,KAAK,EACjCjN,KAAKI,SAAS,CAAE6M,KAAM6G,IACtB9T,KAAKH,MAAM0T,cAAcO,K,+BAcjB,IAAD,EACgB9T,KAAKF,MAApBmN,EADD,EACCA,KAAKwG,EADN,EACMA,MAEb,OACE,6BACI,kBAAC,IAAD,CACExS,IAAK,EACLC,IAAK,GACL6R,MAAOA,GACPO,SAAUtT,KAAKsT,SACf3Q,MAAuB,kBAATsK,EAAoBA,EAAO,IAE3C,kBAAC,IAAD,CAAWtK,MAAOiP,GAAQ3E,KAC1B,kBAAC,IAAD,CAAQmD,KAAK,QAAQ2D,QAASN,EAAOH,SAAUtT,KAAKwT,yB,GA1DpCnQ,IAAMC,WAsFjB0Q,G,YAlBb,WAAYnU,GAAO,IAAD,8BAChB,4CAAMA,KACDC,MAAQ,GAFG,E,oHAWlB,OACE,6BACM,kBAAC,GAAD,CAAayT,cAAevT,KAAKH,MAAM0T,qB,GAf3BlQ,IAAMC,WCzFb2Q,G,YA1Bb,WAAYpU,GAAO,IAAD,8BAChB,4CAAMA,KACDC,MAAQ,GAFG,E,+HASEoU,GAClB3K,QAAQC,IAAI,WAAW0K,GACvBlU,KAAKI,SAAS,CAAE+T,QAAQD,M,+BAI1B,OACE,yBAAKxT,UAAU,aACd,kBAAC,EAAD,CAAOuM,KAAMjN,KAAKF,MAAMqU,UACvB,yBAAKzT,UAAU,eACb,kBAAC,GAAD,CAAS6S,cAAevT,KAAKoU,oBAAoBjU,KAAKH,c,GArB1CqD,IAAMC,WC4CX+Q,G,YAtCb,WAAYxU,GAAO,IAAD,8BAChB,4CAAMA,KACDC,MAAQ,CACX8B,MAAQ,GACRb,QAAS,GAJK,E,oHAiBlB,OACE,yBAAKL,UAAU,OACX,kBAAC,IAAD,CACE4T,SAAS,cAEP,yBAAK5T,UAAU,YACb,kBAAC,IAAD,CAAM+F,GAAG,KACP,kBAAC,IAAD,CAAQkG,MAAM,SAASC,KAAK,WAIhC,kBAAC,IAAD,KACI,kBAAC,IAAD,CAAO2H,KAAK,IAAIC,OAAK,EAACC,UAAW5I,IACjC,kBAAC,IAAD,CAAO0I,KAAK,SAASC,OAAK,EAACC,UAAWR,KACtC,kBAAC,IAAD,CAAOM,KAAK,QAAQC,OAAK,EAACC,UAAWrJ,W,GAjCnC/H,IAAMC,WCCJoR,QACW,cAA7BC,OAAOC,SAASC,UAEe,UAA7BF,OAAOC,SAASC,UAEhBF,OAAOC,SAASC,SAASC,MACvB,2DCZNC,IAASxE,OAAO,kBAAC,GAAD,MAASyE,SAASC,eAAe,SD2H3C,kBAAmBC,WACrBA,UAAUC,cAAcC,MAAM7G,MAAK,SAAA8G,GACjCA,EAAaC,kB","file":"static/js/main.45c28535.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/f1.59fa5dea.jpg\";","module.exports = __webpack_public_path__ + \"static/media/f2.6ca750b9.jpg\";","module.exports = __webpack_public_path__ + \"static/media/f3.bbcb8a3d.jpg\";","module.exports = __webpack_public_path__ + \"static/media/f4.24cc3d72.jpg\";","module.exports = __webpack_public_path__ + \"static/media/f5.d66bc7ad.jpg\";","module.exports = __webpack_public_path__ + \"static/media/f3a.3dc33cc2.jpg\";","module.exports = __webpack_public_path__ + \"static/media/fire.328c90f2.png\";","import React from \"react\";\nimport {\n  Chart,\n  Geom,\n  Axis,\n  Tooltip,\n  Label,\n  Legend\n} from \"bizcharts\";\nimport './vis.css';\n\n\nclass Vis extends React.Component {\n\n  constructor(props){\n    super(props)\n    this.state = {\n      selectFloor : ''\n    }\n  }\n\n\n  componentWillMount(){\n    let self = this\n    this.setTime()\n    setInterval(self.setTime.bind(self), 60000);\n  }\n\n  setTime(){\n    this.setState({curTime: new  Date().toLocaleString().slice(0,-3)})\n  }\n\n  render() {\n    const scale = {\n      percent:{\n        type:\"linear\",\n        min:0,\n        max:100,\n      },\n    }\n    let self = this\n    \n    return (\n      <div>\n        <h2 className='title'>\n          楼层火灾态势感知\n        </h2>\n        <div className='sub-title-container'> \n          <h3 className='sub-title'>\n            地点\n          </h3>\n          <h3 className='sub-title'>\n            {this.state.curTime}\n          </h3>\n        </div>\n        <Chart height={330} data={this.props.data}  padding={50} scale={scale} forceFit\n           onGetG2Instance={g2Chart => {self.chartIns = g2Chart;}}\n           onPlotClick={ev => {\n              var point = {\n                x: ev.x,\n                y: ev.y\n              };\n              var items = self.chartIns.getTooltipItems(point);\n              let floor = items[0]['point']['point']['floor']  \n              self.setState({ selectFloor : floor })\n\n              let sum = 0\n              self.props.data.map((row)=>{\n                if(row['floor']  == floor){\n                   sum += row['percent']\n                }\n              })\n\n              self.props.selectFloor(floor , sum/100)\n            }}\n\n        >\n          <Legend  position='top'/>\n          <Axis name=\"楼层\"  title='楼层'/>\n          <Axis name=\"过火量\" />\n          <Tooltip />\n          <Geom\n            type=\"intervalStack\"\n            position=\"floor*percent\"\n            color={[\"type\" , (filed) => { \n              let color = ['#ad2102','#d4380d']\n              return filed == '上一时刻' ? color[0] : color[1]\n            }]}\n            opacity={['floor' , (floor)=>{ // 回调函数\n              if(self.state.selectFloor == '') return 1\n              if(floor == self.state.selectFloor)\n                return 1;\n              return 0.3;\n              }]}\n\n            style={{\n              stroke: \"#fff\",\n              lineWidth: 1\n            }}\n\n            tooltip={['floor*percent*type', (floor, percent,type) => {\n              return {\n                name: '楼层:' + floor,\n                title: type ,\n                value: '过火量' + percent + '%'\n              };\n            }]}\n          >\n          <Label\n            content='name'\n            formatter={(text, item, index)=>{\n              // console.log(item)\n              // text 为每条记录 x 属性的值\n              // item 为映射后的每条数据记录，是一个对象，可以从里面获取你想要的数据信息\n              // index 为每条记录的索引\n              var point = item.point; // 每个弧度对应的点\n\n              let sum = 0\n\n              self.props.data.map((row)=>{\n                if(row['floor']  == point['floor']){\n                   sum += row['percent']\n                }\n              })\n\n              if(point.type == '新增区域')\n                return sum + '%'\n              return null;\n            }}\n              textStyle={{\n                fill: 'white', // 文本的颜色\n                fontSize: '12', // 文本大小\n                fontWeight: 'bold', // 文本粗细\n              }}\n          />\n          </Geom>\n        </Chart>\n      </div>\n    );\n  }\n}\nexport default Vis\n","var Particle = function(ctx) {\n\tthis.r = Math.random() * 6;\n\t// Initial position will be out of canvas\n\t// but we'll set them later\n\tthis.x = -100;\n\tthis.y = -100;\n\t\n\t// Lets give each particle a different velocity\n\tthis.vy = -5 + parseInt(Math.random() * 10);\n\tthis.vx = -5 + parseInt(Math.random() * 10);\n\t\n\t// A flag to inform if the particle is free to fall or not\n\tthis.isFree = false;\n\t\n\tthis.a = Math.random();\n\t\n\t// Function to draw them\n\tthis.draw = function() {\n\t\tctx.beginPath();\n\t\t// Lets add random opacity\n\t\t// ctx.fillStyle = \"rgba(255, 223, 0, \" +this.a+\")\";\n\t\tctx.fillStyle = \"rgba(250, 84, 28, \" +this.a+\")\";\n\t\tctx.arc(this.x, this.y, this.r, 0, Math.PI*2, false);\n\t\tctx.fill();\n\t\tctx.closePath();\n\t};\n\t\t\n\t// Finally a function to set particle's function\n\tthis.setPos = function(x, y) {\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t}\n};\n\n\nexport default Particle","function arrowTo(ctx, p1, p2, arrowOptions) {\n        // 初始化参数\n        var opts = {\n            startOffset: 2,             // 起点的留空长度\n            endOffset: 2,               // 终点的留空长度\n            offset: 0,                  // 偏移位（模拟动画效果用, 使用时建议将justifyAlign设为false） \n            color: '#E6E6FA',           // 默认颜色 \n            activeIndex: -1,            // 高亮箭头的索引, 超出回到一圈起始位置。(默认-1，不做高亮处理) \n            activeColor: \"#00FF00\",     // 高亮颜色(Highligh Color)\n            stepLength: 5,             // 间隔(步长)\n            justifyAlign: true,         // 两端对齐(两边撑满, 配合activeIndex > 0时使用) \n            arrowLength: 10,            // 箭头长度(柄到顶点)            \n            arrowTheta: 25,             // 箭头两边的夹角（度数） \n            arrowHeadlen: 4,            // 箭头两边斜边长度 \n            arrowLineWidth: 1,          // 画箭头的线宽度\n            lineWidth: 1,               // 两点间的连丝宽度（>0时，有效）\n        };\n \n \n        if (arrowOptions !== undefined && arrowOptions !== null) {\n            opts = Object.assign(opts, arrowOptions);\n        }\n\n        // 计两点距离\n        var len = Math.floor(Math.sqrt(Math.pow(p1.x - p2.x, 2) + Math.pow(p1.y - p2.y, 2)));\n        // 计算画多少个箭头(注意：最后一个箭头是不需要间隔(步长)，所以可用长度要加一个opts.stepLength)\n        var loops = Math.floor((len - (opts.startOffset + opts.offset + opts.endOffset) + opts.stepLength) / (opts.arrowLength + opts.stepLength));\n        // 两端对齐(两边撑满)，重算步长 \n        if (opts.justifyAlign === true) {\n            opts.stepLength = (len - (opts.startOffset + opts.offset + opts.endOffset) - (opts.arrowLength * loops)) / (loops - 1);\n        }\n \n \n        // 高亮箭头的索引, 超出回到一圈起始位置。(用于动画效果) \n        var highlightIndex = 0;               // 0 - 无动画效果                \n        if (opts.activeIndex > 0) {\n            if ((opts.activeIndex % loops) === 0) {\n                highlightIndex = loops;\n            }\n            else {\n                highlightIndex = opts.activeIndex % loops;\n            }\n        }\n \n \n        var hudu = Math.atan2(p1.y - p2.y, p2.x - p1.x);    // 计算p1, p2两点的倾斜度（弧度）。(注意参数：p1.y - p2.y, p2.x - p1.x, 请勿搞错)\n        var p0 = { x: p1.x, y: p1.y };                      // 原点坐标, 作为圆心。 (辅助计算箭头起点(柄)与顶点的坐标)\n        var r;                                              // 半径。 (辅助计算箭头起点(柄)与顶点的坐标)\n        var color;\n        for (var i = 0; i < loops; i++) {\n            // 箭头起点(柄)\n            r = (opts.startOffset + opts.offset) + (opts.arrowLength + opts.stepLength) * i;     // 原点到箭头起点(柄)的半径\n            p1 = {\n                x: p0.x + Math.cos(hudu) * r,\n                y: p0.y - Math.sin(hudu) * r\n            };\n \n \n            // 箭头终点（顶点）\n            r = r + opts.arrowLength;                       // 原点到箭头顶点(柄)的半径\n            p2 = {\n                x: p0.x + Math.cos(hudu) * r,\n                y: p0.y - Math.sin(hudu) * r\n            };\n \n            // 画一个箭头\n            if (highlightIndex > 0 && i === (highlightIndex - 1)) {\n                color = opts.activeColor;       //高亮箭头（动画效果）\n            }\n            else {\n                color = opts.color;\n            }\n            drawArrow(ctx, p1, p2, opts.arrowTheta, opts.arrowHeadlen, opts.arrowLineWidth, color);\n        }\n    }\n \n \n    // 画箭头\n    // ctx - 画布上下文（我理解成画笔）\n    // p1 - 起点\n    // p2 - 终点\n    // theta -- 夹角theta (是度数，不是弧度)\n    // headlen -- 斜边长度\n    // width -- 线宽\n    // color -- 颜色\n    function drawArrow(ctx, p1, p2, theta, headlen, width, color) {\n        theta = (theta !== undefined && theta !== null) ? theta : 25;       //夹角(度数)\n        headlen = (headlen !== undefined && headlen !== null) ? headlen : 6;   //斜边长度\n        width = (width !== undefined && width !== null) ? width : 1;        //线宽\n        color = (color !== undefined && color !== null) ? color : '#000';       //颜色\n \n \n        var angle = Math.atan2(p1.y - p2.y, p1.x - p2.x) * 180 / Math.PI,   //倾斜度(度数)\n            angle1 = (angle + theta) * Math.PI / 180,            //夹角1\n            angle2 = (angle - theta) * Math.PI / 180,            //夹角2   \n            topX = headlen * Math.cos(angle1),                   //箭头上面点, X偏移位\n            topY = headlen * Math.sin(angle1),                   //箭头上面点, Y偏移位\n            botX = headlen * Math.cos(angle2),                   //箭头下面点, X偏移位   \n            botY = headlen * Math.sin(angle2);                   //箭头下面点, Y偏移位      \n        ctx.save();\n\n        ctx.beginPath();\n \n        //连结两点的线\n        ctx.moveTo(p1.x, p1.y);\n        ctx.lineTo(p2.x, p2.y);\n \n \n        //终点箭头的两侧\n        var arrowX = p2.x + topX;\n        var arrowY = p2.y + topY;\n        ctx.moveTo(arrowX, arrowY);\n        ctx.lineTo(p2.x, p2.y);           //终点\n        arrowX = p2.x + botX;\n        arrowY = p2.y + botY;\n        ctx.lineTo(arrowX, arrowY);\n \n \n        //颜色，线宽\n        ctx.strokeStyle = color;\n        ctx.lineWidth = width;\n        ctx.stroke();\n \n \n        ctx.restore();\n    }\n \n \n    // 为Object扩展assign方法（合拼多个对象的属性，返回一个新对象）\n    if (!Object.assign) {\n        Object.defineProperty(Object, \"assign\", {\n            enumerable: false,\n            configurable: true,\n            writable: true,\n            value: function (target, firstSource) {\n                \"use strict\";\n                if (target === undefined || target === null)\n                    throw new TypeError(\"Cannot convert first argument to object\");\n                var to = Object(target);\n                for (var i = 1; i < arguments.length; i++) {\n                    var nextSource = arguments[i];\n                    if (nextSource === undefined || nextSource === null) continue;\n                    var keysArray = Object.keys(Object(nextSource));\n                    for (var nextIndex = 0, len = keysArray.length; nextIndex < len; nextIndex++) {\n                        var nextKey = keysArray[nextIndex];\n                        var desc = Object.getOwnPropertyDescriptor(nextSource, nextKey);\n                        if (desc !== undefined && desc.enumerable) to[nextKey] = nextSource[nextKey];\n                    }\n                }\n                return to;\n            }\n        });\n    }\n\nexport default arrowTo","import React from \"react\";\nimport './map.css';\nimport pic_f1 from '../../image/f1.jpg';\nimport pic_f2 from '../../image/f2.jpg';\nimport pic_f3 from '../../image/f3.jpg';\nimport pic_f4 from '../../image/f4.jpg';\nimport pic_f5 from '../../image/f5.jpg';\nimport pic_f3a from '../../image/f3a.jpg';\n\nimport Particle from '../../util/particle'\nimport arrowTo from '../../util/Draw_traj'\nconst pics = {\n\t'f1' : pic_f1,\n\t'f2' : pic_f2,\n\t'f3' : pic_f3,\n\t'f3a' : pic_f3a,\n\t'f4' : pic_f4,\n\t'f5' : pic_f5,\n}\n\nclass Map extends React.Component {\n\n  constructor(props){\n    super(props)\n    this.state = {\n    }\n\n    this.canvas = React.createRef();\n    this.TrajsCanvas = React.createRef();\n    this.floorTrajs ={\n         'f1' : {\n            'origin':{ x: 350, y: 150},\n            'trajs':[\n                  [{ x: 350, y: 150 },{ x: 360, y: 70 }],\n                  [{ x: 360, y: 70 },{ x: 400, y: 60 }], \n                  [{ x: 350, y: 150 },{ x: 400, y: 100 }],\n                  [{x: 350, y: 150 },{ x: 420, y: 120 }],\n                  [{ x: 350, y: 150 },{ x: 400, y: 160 }]\n                  ]\n                  },\n              'f2' : {\n            'origin':{ x: 550, y: 150},\n            'trajs':[\n                  [{ x: 550, y: 150 },{ x: 520, y: 100 }],\n                  [{ x: 550, y: 150 },{ x: 520, y: 210 }], \n                  [{ x: 550, y: 150 },{ x: 590, y: 100 }],\n                  [{x: 550, y: 150 },{ x: 600, y: 130 }],\n                  [{ x: 550, y: 150 },{ x: 600, y: 160 }]\n                  ]\n                  },\n              'f3' :{\n            'origin':{ x: 350, y: 150},\n            'trajs':[\n                 [{ x: 350, y: 150 },{ x: 350, y: 70 }],\n                  [{ x: 350, y: 70 },{ x: 320, y: 70 }], \n                  [{ x: 350, y: 150 },{ x: 300, y: 200 }],\n                  [{x: 350, y: 150 },{ x: 380, y: 70 }],\n                  [{ x: 350, y: 150 },{ x: 380, y: 170 }]\n                  ]\n                  },\n              'f3a' : {\n            'origin':{ x: 550, y: 200},\n            'trajs':[\n                  [{ x: 550, y: 200 },{ x: 570, y: 130 }],\n                  [{ x: 550, y: 200 },{ x: 590, y: 150 }], \n                  [{ x: 550, y: 200 },{ x: 580, y: 190 }],\n                  // [{x: 550, y: 150 },{ x: 600, y: 130 }],\n                  // [{ x: 550, y: 150 },{ x: 600, y: 160 }]\n                  ]\n                  },\n              'f4' : {\n            'origin':{ x: 450, y: 150},\n            'trajs':[\n                  [{ x: 450, y: 150 },{ x: 510, y: 100 }],\n                  [{x: 510, y: 100},{ x: 480, y: 90 }], \n                  [{x: 450, y: 150 },{ x: 500, y: 200 }],\n                  [{x: 450, y: 150 },{ x: 400, y: 100 }],\n                  [{ x: 390, y: 100 },{ x: 410, y: 75 }]\n                  ]\n                  },\n              'f5' : {\n            'origin':{ x: 550, y: 150},\n            'trajs':[\n                  [{ x: 550, y: 150 },{ x: 410, y: 120 }],\n                  [{ x: 410, y: 120 },{ x: 410, y: 90 }],\n                  [{x: 550, y: 150 },{ x: 520, y: 100 }],\n                  [{ x: 550, y: 150 },{ x: 600, y: 100 }]\n                  ]\n                  },\n        }\n    }\n\n  componentDidMount(){\n  \tconsole.log(this.canvas)\n\n  \tthis.drawBurns()\n    // this.drawTrajs()\n  }\n\n  // 用 canvas 画团火焰\n  drawBurns(){\n  \tlet canvas = this.canvas\n  \tif(!canvas  || !canvas.current) return\n\n  \tcanvas = this.canvas.current\n  \tlet height = canvas.clientHeight\n  \tlet width  = canvas.clientWidth\n  \tlet ctx = canvas.getContext(\"2d\");\n\n  \tlet particles = []\n\n  \tlet boundry = {\n  \t\tleft : 50,\n  \t\twidth: 210,\n  \t\ttop : 25,\n  \t\theight:100,  \n    }\n\n    let percent = this.props.percent\n    // console.log(percent , Math.sqrt(percent))\n    // let percent = 1\n\n    // 着火 中心点 \n    // let centerPercent = [0 , 0],\n    //   center = [boundry.left + boundry.width * centerPercent[0], \n    //         boundry.top + boundry.height * centerPercent[1]]\n    let centerMap = {\n      'f1' : [90,30],\n      'f2' : [120,70],\n      'f3' : [160,40 ],\n      'f3a' : [120,60],\n      'f4' :  [100,70],\n      'f5' :  [110,30],\n    }\n    let center = centerMap[this.props.floor]\n\n    // 标定\n    // let center = [ boundry['left'] + boundry.width /2 ,\n    //                 boundry['top'] + boundry.height /2]\n\n\n    // 蔓延范围\n    // let xmin = center[0] - boundry.width * Math.sqrt(percent) / 2 , \n    //   xmax = center[0] + boundry.width * Math.sqrt(percent) / 2 ,\n    //   ymin = center[1] - boundry.height * Math.sqrt(percent) / 2 ,\n    //   ymax = center[1] + boundry.height * Math.sqrt(percent) / 2 \n\n    let xmin = center[0] - boundry.width * percent / 2 , \n      xmax = center[0] + boundry.width * percent / 2 ,\n      ymin = center[1] - boundry.height * percent / 2 ,\n      ymax = center[1] + boundry.height * percent / 2 \n\n      xmin =  (xmin < boundry.left ) ?  boundry.left : xmin\n      ymin =  (ymin < boundry.top ) ?   boundry.top : ymin\n      xmax =  (xmax > (boundry.left+boundry.width)) ? (boundry.left+boundry.width) : xmax\n      ymax =  (ymax > (boundry.top+boundry.height)) ? (boundry.top+boundry.height) : ymax\n\n\n    // 火苗\n    for(let i = 0;i < 300*percent;i++){\n      let p = new Particle(ctx)\n      p.x = getRandomInt(xmin , xmax)\n      p.y = getRandomInt(ymin , ymax )\n      particles.push(p)\n    }\n    ctx.globalCompositeOperation = \"lighter\";\n\n    function update() {\n      clear()\n      particles.map((p)=>{\n        p.r += 0.15;\n      p.a -= 0.015;\n      if(p.a < 0) {\n        p.r = Math.random() * 4;\n        p.a = Math.random();\n      }\n      p.draw()\n      })\n    }\n    \n    function clear() {\n      ctx.clearRect(0, 0, width, height);\n    }\n    let timeoutId = setInterval(update, 1000 / 30);\n    this.setState({ timeoutId })\n\n  };\n  //canvas绘制逃生轨迹\n  drawTrajs(){\n    let myCanvas = this.TrajsCanvas\n    if(!myCanvas  || !myCanvas.current) return\n    // myCanvas.style.cssText = \"position:absolute;left:0;top:0; border: 1px solid #ccc;\"; // 画布样式\n    myCanvas = this.TrajsCanvas.current\n    let height = myCanvas.clientHeight\n    let width  = myCanvas.clientWidth\n    myCanvas.width = 690;   // 画布的宽度\n    myCanvas.height = 360;  // 画布的高度 \n   // 画笔（绘图对象）\n    var ctx = myCanvas.getContext('2d');\n \n    // ctx.fillStyle = \"red\";\n    // ctx.arc(350, 150,5, 0, Math.PI*2, false);\n\n   \n    // 动画效果\n    var _index = 1;\n    var selfthis = this\n    setInterval(function () {\n        // 清空画布\n        var BW = myCanvas.width;\n        var BH = myCanvas.height;\n        ctx.clearRect(0, 0, BW, BH);                // 清空画布\n        if(selfthis.props.floor)\n          var infs = selfthis.floorTrajs[selfthis.props.floor] \n        else\n          var infs = selfthis.floorTrajs['f1']\n        ctx.beginPath();\n        ctx.fillStyle = \"red\";\n        ctx.arc(infs['origin']['x'],infs['origin']['y'],3, 0, Math.PI*2, false);\n        ctx.fill();\n        ctx.closePath();\n        // 整体偏移效果\n        var offset = (_index % 3) * 5; \n        for(var i=0;i<infs['trajs'].length;i++)\n        {\n          arrowTo(ctx,infs['trajs'][i][0], infs['trajs'][i][1],{ offset: offset, color: \"red\", justifyAlign: false });\n        }\n//         arrowTo(ctx,{ x: 350, y: 150 }, { x: 360, y: 70 },  { offset: offset, color: \"red\", justifyAlign: false });\n//         arrowTo(ctx,{ x: 360, y: 70 }, { x: 400, y: 60 },  { offset: offset, color: \"red\", justifyAlign: false });\n//         arrowTo(ctx, { x: 350, y: 150 }, { x: 400, y: 100 }, { offset: offset, color: \"red\", justifyAlign: false });\n//         arrowTo(ctx, { x: 350, y: 150 }, { x: 420, y: 130 }, { offset: offset, color: \"red\", justifyAlign: false });\n//         arrowTo(ctx, { x: 350, y: 150 },  { x: 400, y: 160 }, { offset: offset, color: \"red\", justifyAlign: false });\n \n        // 其他处理\n        if (_index >= 50) {\n            _index = 1\n        }\n        else {\n            _index++;\n        }\n    }, 300);\n}\n  render() {\n    return (\n      <div className='container'>\n        <h2 className='return-btn' onClick={this.props.return}> 返回 </h2>\n        <img src={pics[ this.props.floor ] ||  pics['f1']}  className='image' />\n        <canvas ref={this.canvas}/>\n        <canvas ref={this.TrajsCanvas}/>\n      </div>\n    );\n  }\n\n}\n\nfunction getRandomInt(min, max) {\n    min = Math.ceil(min);\n    max = Math.floor(max);\n    return Math.floor(Math.random() * (max - min + 1)) + min;\n}\n\n\n\nexport default Map\n","import React from 'react';\nimport { BrowserRouter, Route, Link, Switch } from 'react-router-dom'\nimport './index.css';\nimport Vis from './vis';\nimport Map from './map';\n\n\nimport { BorderBox1,BorderBox2,\n        BorderBox8\n    } from '@jiaminghi/data-view-react'\n\nclass Fire extends React.Component {\n  \n  constructor(props){\n    super(props)\n    this.state = {\n      floor : '',\n      percent: 0\n    }\n  }\n\n  componentWillMount(){\n    let floors = ['F1','F2','F3','F3a','F4','F5']\n    let types  = ['新增区域','上一时刻']\n    let data = []\n\n    for(let i = 0;i < floors.length;i++){\n      for(let j = 0;j < types.length;j++){\n          let percent = Math.round(Math.random() * 25)\n          if(floors[i] == 'F4' && types[j] == '新增区域')\n              percent = 25\n          if(floors[i] == 'F4' && types[j] == '上一时刻')\n              percent = 40          \n\n          data.push({\n            'floor' : floors[i],\n            'type'  : types[j],\n            'percent' : percent\n          })\n      }\n    }\n    this.setState({\n      data \n    })\n  }\n\n  handleFlooeSelect(floor , percent){\n    this.setState({ \n      floor:floor.toLowerCase(),\n      percent : percent\n    })\n  }\n\n  handleReturn(){\n    console.log('return')\n    this.setState({\n       floor : ''\n    })\n  }\n\n  render(){\n\n    const vis = (<Vis \n                      data={this.state.data} \n                      selectFloor={this.handleFlooeSelect.bind(this)} \n                      /> )\n\n    const map = (<Map \n                      floor={this.state.floor} \n                      return={this.handleReturn.bind(this)} \n                      percent={this.state.percent}\n                    /> )\n\n  return (\n    <div className=\"fire-app\">       \n      <div className='panel'>   \n        <BorderBox2 >\n          {  this.state.floor == ''  ? vis :   map }\n        </BorderBox2>\n      </div>\n    </div>\n  )}\n}\n\nexport default Fire;\n","import React from 'react';\nimport { BrowserRouter, Route, Link, Switch,withRouter } from 'react-router-dom'\nimport { Card, Col, Row,Button } from 'antd';\nimport './index.css';\nimport fireImg from '../../image/snapshots/fire.png'\n\nclass Board extends React.Component {\n  \n  constructor(props){\n    super(props)\n    this.state = {\n\n    }\n  }\n\n  componentWillMount(){\n  \n\n  }\n  redirectTo(route){\n    this.props.history.push(route)\n  }\n\n\n  render(){\n    const coverStyle = {\n      height : '300px'\n    }\n  return (\n  <div className='board-app'>\n    <Row gutter={16}>\n      \n      <Col span={8}>\n        <Card\n          hoverable\n          cover={<img alt=\"example\" src={fireImg} style={coverStyle}/>}\n          onClick={this.redirectTo.bind(this,'/fire')}\n        >\n          <Card.Meta \n            title=\"火灾可视化\" \n            description=\"展示商城中不同楼层的火灾情况\" />\n        </Card>\n      </Col>\n\n      <Col span={8}>\n        <Card  \n          hoverable\n          cover={<img alt=\"example\"  style={coverStyle}/>}\n          onClick={this.redirectTo.bind(this,'/urban')}\n        >\n          <Card.Meta \n            title=\"城市可视化\" \n            description=\"使用 @antv/L7 进行展示\" />\n        </Card>\n      </Col>\n    </Row>\n\n    <div className='links-contain'>\n      <a href='https://github.com/AgeBing/vis-works'>\n        <Button shape=\"circle\" icon=\"github\"/>\n      </a>\n    </div>\n    \n  </div>\n  )}\n}\n\nexport default withRouter(Board);\n","import React, { Component } from 'react'\nimport * as d3 from 'd3'\nimport * as L7 from '@antv/l7';\n\n// 采用七牛云 存储 \n// 注意 30 天绑定域名会变化\nconst centerCsvUrl = 'http://q1vcletmu.bkt.clouddn.com/center_gcj02.csv'\nconst centerRoadUrl = 'http://q1vcletmu.bkt.clouddn.com/road_400_f.csv'\nconst trajsUrlBase = \"http://q1vcletmu.bkt.clouddn.com/\"\nconst movesUrl = \"https://gw.alipayobjects.com/os/basement_prod/40ef2173-df66-4154-a8c0-785e93a5f18e.json\"\nconst kakouCsvUrl = 'http://q1vcletmu.bkt.clouddn.com/kakou.csv'\n\nclass MyMap extends Component {\n  state = {\n  }\n \n  constructor(props) {\n    super(props)\n  }\n\n  componentDidMount(){\n    this.createInstance()\n  }\n  componentWillReceiveProps(nextProps) {\n\n    if (this.props.hour !== nextProps.hour && this.props.hour ){\n        let hour = nextProps.hour\n        console.log('render' , hour)\n        this.drawLinesUpdate(this.state.trajs[hour])\n    }\n  }\n  async createInstance(){\n    let self = this\n    var scene = new L7.Scene({\n      id: 'map',\n      // mapStyle: 'dark',\n      mapStyle: 'light',\n      center: [114.5082664490,38.0413316426],\n      // center: [120.19382669582967, 30.258134],\n      pitch: 60,\n      // zoom: 13.2,\n      zoom: 13.8,\n      zoomControl: false,\n      scaleControl: false,\n      attributionControl: false\n    });\n    this.scene = scene\n    scene.on('loaded', async function() {\n        let kakou = await self.getKakous()\n        let trajs = await self.getTrajs(kakou.map)\n        console.log(trajs)\n        self.drawPoints(kakou.arr)\n        self.setState({ trajs })\n\n        // for(let i = 0; i < 14;i++){\n        //   let T  = 2000\n        //   setTimeout(()=>{\n        //       self.drawLinesUpdate(trajs[i])\n        //   },T * i)\n        // }\n\n    })\n  }\n  async getKakous(){\n    return new Promise((resolve,reject)=>{\n        d3.csv(kakouCsvUrl).then((data)=>{\n          let kakous = []\n          let ids = new Set()\n          let kakouMap = new Map()\n          // data = data.slice(0,20)\n          data.map((row)=>{\n              if(row['location'] == '二环内'){\n                  let id = row['I_ID'],\n                      lng =  +row['longitude'],\n                      lat =  +row['latitude']\n                  if(!ids.has(id)){\n                    kakous.push({\n                        id , lng , lat,\n                        name : id\n                    })\n                    // kakous.push({\n                    //   \"type\": \"Feature\",\n                    //   \"geometry\": {\n                    //     \"type\": \"Point\",\n                    //     \"coordinates\": [lng, lat]\n                    //   },\n                    //   \"properties\": {\n                    //       \"name\": id\n                    //   }\n                    // })\n                    kakouMap.set(id , { lng ,lat })\n                  }\n                  ids.add(row['I_ID'])\n              }\n          })  \n          console.log(kakous.length)\n          // kakous = {\n          //   \"type\": \"FeatureCollection\",\n          //   \"features\": kakous\n          // }\n          resolve( { arr:kakous,map:kakouMap }  )\n        })\n    })\n  }\n  async getTrajs(kakouMap){\n\n    let ps = []\n\n    for(let i = 1;i < 15;i++){\n        let p = new Promise((resolve,reject)=>{\n\n                    let trajUrl = trajsUrlBase + \"t_df_\" + i + \".csv\"\n                    d3.csv(trajUrl).then((data)=>{\n                      let trajs = []\n                      data.map((row)=>{\n                        let s = row['s'],\n                            e = row['e'],\n                            s_p = kakouMap.get(s),\n                            e_p = kakouMap.get(\"\"+e)\n                        if(s_p && e_p){  // 卡口点存在\n                          trajs.push({\n                            lng1 : s_p['lng'],\n                            lat1 : s_p['lat'],\n                            lng2 : e_p['lng'],\n                            lat2 : e_p['lat']\n                          })\n                        }\n                      })  \n                      console.log(trajs.length)\n                      resolve( trajs )\n                    })\n                })\n\n        ps.push( p )\n    }\n\n    return Promise.all(ps)\n  }\n  drawPoints(points){\n      let self = this\n      let pl = self.scene.PointLayer({\n          zIndex: 2\n      })\n      .source(points,{\n        parser:{\n            type:'json',\n            x : 'lng',\n            y : 'lat',\n            name: 'name',\n        },\n      })\n      .shape('circle')\n      // .shape('name', 'text')\n      .size(1) \n      .active(true)\n      .color('#ffc53d')\n      .style({\n        opacity: 0.8,\n        strokeWidth: 0\n      })\n      .render();\n      pl.setHeight(10)\n\n      pl.on('click', (ev)=>{\n        console.log(ev)\n      });\n  }\n  prepareLineLayer(){\n    let self = this\n\n    let ll = self.scene.LineLayer({\n      zIndex: 3\n    })\n    .shape('line')\n    .size(3)\n    .color('#722ed1')\n    .style({\n      opacity: 0.85,\n    })\n    .animate({\n      enable:true, // 开启动画\n      interval:0.2, //  0-1 轨迹间隔 \n      duration:2, // 动画时间\n      trailLength:0.4, // 轨迹长度 0-1\n    })\n    .render()\n    console.log(ll)\n\n    return ll \n      // .render();\n  }\n  drawLinesUpdate(lines){\n    let ll \n    let self = this\n    if(!self.trajsLayer){\n      let ll = self.scene.LineLayer({\n        zIndex: 3\n      })\n      .source(lines, {\n        parser: {\n          type:'json',\n          x: 'lng1',\n          y: 'lat1',\n          x1: 'lng2',\n          y1: 'lat2'\n        }\n      })\n      .shape('line')\n      .size(3)\n      .color('#40a9ff')\n      .style({\n        opacity: 0.85,\n      })\n      .animate({\n        enable:true, // 开启动画\n        interval:0.2, //  0-1 轨迹间隔 \n        duration:2, // 动画时间\n        trailLength:0.4, // 轨迹长度 0-1\n      })\n      .render()\n\n      self.trajsLayer = ll\n    }else{\n      console.log(lines.length)\n      ll = self.trajsLayer\n      ll.setData(lines, {\n        parser: {\n          type:'json',\n          x: 'lng1',\n          y: 'lat1',\n          x1: 'lng2',\n          y1: 'lat2'\n        }\n      })\n\n    }\n  }\n  render() {\n    return (\n      <div\n        id='map'\n        style={{\n          width: '100%',\n          margin: '0',\n          height: '100%',\n          position: 'absolute'\n        }}\n        ref={div => {\n          this.mapWrapper = div\n        }}\n      >\n      </div>\n    )\n  }\n}\nexport default MyMap","import React from 'react';\nimport { BrowserRouter, Route, Link } from 'react-router-dom'\nimport './index.css';\n\n\nimport { Slider, InputNumber, Row, Col, Statistic ,Switch } from 'antd';\n\nconst { Countdown } = Statistic;\nconst deadline = Date.now() + 1000 * 60 * 60 * 24 * 2 + 1000 * 30; // Moment is also OK\n\nconst TIME_GAP = 3000   // 2秒一更新\n\nDate.prototype.format = function(fmt){\n  var o = {\n    \"M+\" : this.getMonth()+1,                 //月份\n    \"d+\" : this.getDate(),                    //日\n    \"h+\" : this.getHours(),                   //小时\n    \"m+\" : this.getMinutes(),                 //分\n    \"s+\" : this.getSeconds(),                 //秒\n    \"q+\" : Math.floor((this.getMonth()+3)/3), //季度\n    \"S\"  : this.getMilliseconds()             //毫秒\n  };\n\n  if(/(y+)/.test(fmt)){\n    fmt=fmt.replace(RegExp.$1, (this.getFullYear()+\"\").substr(4 - RegExp.$1.length));\n  }\n        \n  for(var k in o){\n    if(new RegExp(\"(\"+ k +\")\").test(fmt)){\n      fmt = fmt.replace(\n        RegExp.$1, (RegExp.$1.length==1) ? (o[k]) : ((\"00\"+ o[k]).substr((\"\"+ o[k]).length)));  \n    }       \n  }\n\n  return fmt;\n}\n\nfunction getTime(hour) {\n  let year = 2019,\n      month = 1,\n      day   = 3,\n      hours = hour,\n      minutes = 0,\n      seconds = 0,\n      milliseconds = 0\n  let d = new Date(year, month, day, hours, minutes, seconds, milliseconds)\n  d = d.format(\"hh:mm:ss\");\n  return d\n}\n\nconst marks = {\n  0 : '0:00',\n  6 : '6:00',\n  12: '12:00',\n  18: '18:00',\n  24: '24:00',\n}\n\nclass IntegerStep extends React.Component {\n  constructor(props){\n    super(props)\n    this.state = {\n      hour : 1,\n      start: false,\n      startId : 0\n    }\n  }\n\n  componentWillMount(){\n    let self = this\n  }\n\n  onChange = value => {\n    this.setState({\n      hour: value,\n    })\n\n    this.props.updateMapTime(value)\n  };\n\n  // 跟新时间 \n  timer() {\n    let self = this\n\n    if(self.state.hour >= 23 ){\n      clearInterval( self.state.startId )\n    }\n    let updateTime = self.state.hour+1\n    this.setState({ hour: updateTime});\n    this.props.updateMapTime(updateTime)\n  }\n  handleStartChange = (start) =>{\n\n    let self = this\n    if(start){\n      let _startId = setInterval(self.timer.bind(self),TIME_GAP)\n      self.setState({ startId:_startId })\n    }else{\n      clearInterval( self.state.startId )\n    }\n    this.setState({ start })\n  }\n\n  render() {\n    const { hour,start } = this.state;\n\n    return (\n      <div>\n          <Slider\n            min={0}\n            max={24}\n            marks={marks}\n            onChange={this.onChange}\n            value={typeof hour === 'number' ? hour : 2}\n          />\n          <Statistic value={getTime(hour)}/ >\n          <Switch size=\"small\" checked={start} onChange={this.handleStartChange} />\n      </div>\n    );\n  }\n}\n\n\n\nclass Widgets extends React.Component {\n  \n  constructor(props){\n    super(props)\n    this.state = {\n    }\n  }\n\n  componentWillMount(){\n\n  }\n\n  render(){\n  return (\n    <div>       \n          <IntegerStep updateMapTime={this.props.updateMapTime}/>\n    </div>\n  )}\n}\n\nexport default Widgets;\n","import React from 'react';\nimport { BrowserRouter, Route, Link, Switch } from 'react-router-dom'\nimport './index.css';\n\nimport MyMap from './Scene';\nimport Widgets from  './TimeWidget'\n\nclass Urban extends React.Component {\n  \n  constructor(props){\n    super(props)\n    this.state = {\n    }\n  }\n\n  componentWillMount(){\n\n  }\n  handleUpdateMapTime(h){\n    console.log(\"map time\",h)\n    this.setState({ mapTime:h })\n  }\n\n  render(){\n  return (\n    <div className=\"urban-app\">       \n    \t<MyMap hour={this.state.mapTime}></MyMap>\n      <div className='widget-time'>\n        <Widgets updateMapTime={this.handleUpdateMapTime.bind(this)} >\n        </Widgets>\n      </div>\n    </div>\n  )}\n}\n\nexport default Urban;\n","import React from 'react';\nimport { BrowserRouter, Route, Link, Switch } from 'react-router-dom'\n\nimport './App.css';\nimport 'antd/dist/antd.css';\n\nimport { Icon,Button } from 'antd'\nimport  Fire from './components/fire/index'\nimport  Board from './components/board/index'\nimport  Urban from './components/urban/index'\n\nclass App extends React.Component {\n  \n  constructor(props){\n    super(props)\n    this.state = {\n      floor : '',\n      percent: 0\n    }\n  }\n\n  componentWillMount(){\n  \n  }\n\n  render(){\n    const Index = () => <div>Index页面</div>\n\n    const About = () => <div>About页面</div>\n\n  return (\n    <div className=\"App\">   \n        <BrowserRouter\n          basename='/vis-works'\n        >\n            <div className='home-btn'>\n              <Link to='/'>\n                <Button shape=\"circle\" icon=\"home\"/>\n              </Link>\n            </div>\n            {/*路由配置*/}\n            <Switch>\n                <Route path='/' exact component={Board}></Route>\n                <Route path='/urban' exact component={Urban}></Route>\n                <Route path='/fire' exact component={Fire}></Route>\n            </Switch>\n        </BrowserRouter>\n    </div>\n  )}\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}